Пошаговое руководство: Создание "пуленепробиваемого" шаблона (template.pptx)

Цель: Создать файл .pptx, который твой Python-скрипт сможет читать как "API-контракт". Мы создадим "чертеж" (Макет), на котором Python будет знать "адреса" (idx) всех твоих текстовых полей.

Ключевой принцип: Мы ничего не рисуем на обычном слайде. Мы работаем только в режиме "Образца слайдов" (Slide Master).

1. Самая главная ошибка (Чего НЕ делать)

НЕЛЬЗЯ:
Открывать PowerPoint и сразу начинать рисовать на первом же (обычном) слайде, используя инструмент "Надпись" (Text Box) для "Заголовка" или "Номера слайда".

ПОЧЕМUTH? Для Python-скрипта эти блоки — просто "мусор". У них нет стабильных ID. Это как строить дом без фундамента.

2. "Рецепт" на 5 минут (Как НАДО делать)

Вот пошаговая инструкция.

Шаг 1: Войди в "Режим Архитектора" (Образец слайдов)

Открой PowerPoint. Создай абсолютно пустую презентацию.

Сразу удали титульный слайд, который он предлагает. Нам нужен чистый файл.

Перейди во вкладку "Вид" (View).

Нажми на большую кнопку "Образец слайдов" (Slide Master).
(Ты вошел в "режим архитектора".)

Шаг 2: Создай свой "Чертеж" (Макет)

Слева ты увидишь иерархию. Самый верхний, большой слайд (с '1') — это Образец (Master). Все, что ниже и с отступом — это Макеты (Layouts).

Удали все Макеты (маленькие, с отступом), кроме одного.

Кликни правой кнопкой мыши на этот единственный оставшийся макет (маленький слайд с отступом).

Выбери "Переименовать макет" (Rename Layout).

[cite_start]Критически важно: Дай ему короткое, "машинное" имя латиницей. Например: VideoLayout[cite: 49].
(Это имя — твой главный "ID" для Python-скрипта.)

Шаг 3: Настрой Фон (Твой темный фон)

Это нужно сделать до настройки текста, чтобы видеть, что делаешь.

В списке слева кликни на самый верхний, большой слайд ('1') — «Родителя» (Master).

На вкладке «Образец слайдов» нажми «Стили фона» (Background Styles) -> «Формат фона...» (Format Background).

Справа выбери «Сплошная заливка» (Solid Fill) и установи свой темный цвет (черный, темно-серый).

(Теперь твой VideoLayout и все будущие макеты автоматически унаследуют этот фон.)

Шаг 4: Определи "Адреса" для Текста (Заполнители)

ВАЖНО: Теперь кликни обратно на свой макет VideoLayout (маленький слайд).

Убедись, что ты все еще на вкладке "Образец слайдов". Кнопка "Вставить заполнитель" (Insert Placeholder) должна быть активна.

Заголовок:

Нажми "Вставить заполнитель" -> "Текст" (Text).

Нарисуй прямоугольник там, где у тебя должен быть Заголовок.

(Очистка): Кликни на "Образец текста", удали все уровни, кроме первого. Выдели эту строку и на вкладке "Главная" (Home) ОТОЖМИ кнопку "Маркеры" (Bullets).

Настрой в этом блоке нужный шрифт, размер и светлый цвет (белый, светло-серый).

Номер слайда:

Снова нажми "Вставить заполнитель" -> "Текст" (Text).

Нарисуй второй, маленький текстовый блок.

Перетащи его в свой желтый круг.

Повтори (Очистку): Удали лишние уровни, отожми маркеры. Настрой шрифт (напр., жирный, темный (для желтого фона), 12pt, по центру).

(Ты только что создал два "адреса", по которым Python будет вставлять текст.)

Шаг 5: Нарисуй "Декорации" (Статичные фигуры)

(Убедись, что ты все еще на макете VideoLayout)

Прямо здесь же, иди во вкладку "Вставка" (Insert) -> "Фигуры" (Shapes) -> "Овал" (Oval).

Нарисуй свой Желтый Круг.

Кликни на него правой кнопкой -> "На задний план" (Send to Back).

Подвигай его так, чтобы твой "Заполнитель номера" (который ты создал в Шаге 4) оказался на его фоне.

Шаг 6: Определи Зону для Скриншотов (Важно: Пустота)

ВОПРОС: Куда вставлять скриншоты?

ОТВЕТ: НИКУДА. Просто оставь пустое место на макете VideoLayout там, где они должны быть.

ПОЧЕМУ?
[cite_start]*   Если ты добавишь "Заполнитель изображения" (Picture Placeholder), PowerPoint будет пытаться растянуть и обрезать (crop) твои скриншоты, чтобы они влезли в рамку[cite: 56, 57]. Это исказит их.

Мы будем использовать Python-скрипт, чтобы "приклеивать" скриншоты поверх этого пустого места, используя точные абсолютные координаты (в дюймах) [cite: 58, 61]. [cite_start]Только так гарантируется сохранение пропорций[cite: 61].

Шаг 7: Сохрани "Чертеж"

На вкладке "Образец слайдов" нажми "Закрыть режим образца" (Close Master View).

Твой экран станет пустым (или покажет пустой макет). Это нормально.

Нажми "Файл" -> "Сохранить как" и сохрани этот файл в папке твоего проекта под именем template.pptx.

3. Финальный шаг: Запусти "Сканер"

Теперь ты готов. У тебя есть template.pptx.

Возьми скрипт analyze_template.py (эналайз темплейт пай).

Убедись, что в нем TARGET_LAYOUT_NAME = 'VideoLayout'.

Запусти его.

Он "просканирует" твой файл и выдаст "адреса" (idx), которые ты только что создал в Шаге 4. Это будут idx (индексы) для твоего "Заголовка" и "Номера слайда".

ВСЁ. Теперь этот template.pptx "пуленепробиваемый".
