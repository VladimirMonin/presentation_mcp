# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ImagePlacer

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è WebP ‚Üí PNG

WebP –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è `python-pptx` –Ω–∞–ø—Ä—è–º—É—é. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **in-memory** –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:

```python
# ImageProcessor.convert_webp_to_png()
webp_image = Image.open(image_stream)
png_buffer = BytesIO()
webp_image.save(png_buffer, format='PNG')
return png_buffer
```

**–ú–µ—Å—Ç–æ:** `core/image_processor.py`

### 2. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ GIF

GIF-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ `add_picture()` –±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏. PowerPoint –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ GIF –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏.

### 3. –£–º–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

–ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:

```python
# ImagePlacer._calculate_scaled_dimensions()
img_ratio = img_width / img_height
box_ratio = width / height

if img_ratio > box_ratio:
    # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à–∏—Ä–µ ‚Üí —Ñ–∏–∫—Å–∏—Ä—É–µ–º —à–∏—Ä–∏–Ω—É
    final_width = width
    final_height = width / img_ratio
else:
    # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—ã—à–µ ‚Üí —Ñ–∏–∫—Å–∏—Ä—É–µ–º –≤—ã—Å–æ—Ç—É
    final_height = height
    final_width = height * img_ratio
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:** –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è** –∏ –Ω–µ –∏—Å–∫–∞–∂–∞–µ—Ç—Å—è.

### 4. –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –æ—Ç–≤–µ–¥—ë–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏:

```python
left_offset = (width - final_width) / 2
top_offset = (height - final_height) / 2
```

## –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

- ‚úÖ PNG, JPEG, BMP, TIFF
- ‚úÖ WebP (–∞–≤—Ç–æ–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ PNG)
- ‚úÖ GIF (–≤–∫–ª—é—á–∞—è –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

`ImagePlacer` —Å–ª–µ–¥—É–µ—Ç **Single Responsibility Principle**:

- –ü–æ–ª—É—á–∞–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–∞–∫–µ—Ç–∞ –∏–∑ `LayoutRegistry`
- –†–µ–∑–æ–ª–≤–∏—Ç –ø—É—Ç–∏ —á–µ—Ä–µ–∑ `ResourceLoader`
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã —á–µ—Ä–µ–∑ `ImageProcessor`
- –†–∞–∑–º–µ—â–∞–µ—Ç –Ω–∞ —Å–ª–∞–π–¥–µ —á–µ—Ä–µ–∑ `add_picture()`

**–§–∞–π–ª:** `core/placers/image_placer.py` (~250 —Å—Ç—Ä–æ–∫)

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ `technical/logging.md`:

- üñºÔ∏è –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è WebP
- ‚öñÔ∏è –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚ùå –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏/–æ–±—Ä–∞–±–æ—Ç–∫–∏
